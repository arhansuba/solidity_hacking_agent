# vulnerability_trends_dashboard.py

import os
import matplotlib.pyplot as plt
import pandas as pd
import json

class VulnerabilityTrendsDashboard:
    def __init__(self, data_file='data/vulnerability_trends.json'):
        self.data_file = data_file
        self.data = self.load_data()

    def load_data(self):
        if not os.path.isfile(self.data_file):
            raise FileNotFoundError(f"Data file {self.data_file} not found.")
        
        with open(self.data_file, 'r') as file:
            data = json.load(file)
        
        return pd.DataFrame(data)

    def plot_vulnerability_trends(self):
        df = self.data
        vulnerabilities = df['vulnerability'].unique()

        plt.figure(figsize=(12, 8))
        for vulnerability in vulnerabilities:
            vuln_data = df[df['vulnerability'] == vulnerability]
            plt.plot(vuln_data['date'], vuln_data['count'], label=vulnerability)

        plt.xlabel('Date')
        plt.ylabel('Number of Incidents')
        plt.title('Vulnerability Trends Over Time')
        plt.legend()
        plt.grid(True)
        plt.tight_layout()

        plt.savefig('output/vulnerability_trends_dashboard.png')
        plt.show()

# Example usage
if __name__ == "__main__":
    dashboard = VulnerabilityTrendsDashboard()
    dashboard.plot_vulnerability_trends()
